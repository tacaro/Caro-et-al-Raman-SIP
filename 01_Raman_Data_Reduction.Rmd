---
title: "01_Raman_Data_Reduction"
author: "Tristan Caro"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup

## Clear the environment

```{r}
rm(list=ls())
```


## Load Libraries

```{r}
require(tidyverse)
require(ggdist)
require(latex2exp)
```

## Load Source

```{r}
source(file = "source/read_raman_file.R")
source(file = "source/plot_raman.R")
source(file = "source/calculate_CD.R")
```


```{r}
test_df <- read_raman_file("data/Raman/Thy_50_12/baseline_corr/Thy_50_12_02_1x_45s_532 nm_x100_100%_600 gr_mm_01.txt")
```

```{r}
test_df2_areas <- 
  test_df2 %>% 
  group_by(band) %>% 
  summarize(
    area = sum(intensity)
  ) %>% 
  ungroup() %>% 
  filter(!is.na(band)) %>% 
  summarize(
    cd_frac = )
  
test_df <- calculate_CD(test_df)

```


```{r}

plot_raman <- function(df) {
  df %>% ggplot(
    aes(
      x = wavenumber_cm,
      y = intensity
    )
  ) +
    # Shade the CD stretch
    geom_area(data = df %>% filter(band == "CD"),
              fill = "red",
              alpha = 0.5
    ) +
    # Shade the CH stretch
    geom_area(data = df %>% filter(band == "CH"),
              fill = "blue",
              alpha = 0.5
    ) +
    # Add the zero line
    geom_hline(
      yintercept = 0,
      alpha = 0.5,
      color = "gray") +
    geom_line(color = "black") +
    theme_classic() +
    labs(
      x = TeX("Wavenumber $(cm^{-1})$"),
      y = "Intensity",
    )
}

plot_raman(test_df)
```

